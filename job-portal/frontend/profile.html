<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Profile - Job Portal</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <main class="profile-container">
    <h1>Your Profile</h1>
    <form id="profileForm">
      <label for="name">Full Name</label>
      <input type="text" id="name" name="name" />

      <label for="email">Email (readonly)</label>
      <input type="email" id="email" name="email" readonly />

      <label for="resume">Resume URL</label>
      <input type="url" id="resume" name="resume" placeholder="Link to your resume" />

      <label for="skills">Skills (comma separated)</label>
      <input type="text" id="skills" name="skills" placeholder="e.g. JavaScript, Node.js, React" />

      <button type="submit">Update Profile</button>
    </form>
  </main>

<script>
  const token = localStorage.getItem('token');

  // Load user profile
  async function loadProfile() {
    const res = await fetch('/api/profile/me', {
      headers: { Authorization: `Bearer ${token}` }
    });
    const user = await res.json();

    document.getElementById('name').value = user.firstName + ' ' + user.lastName;
    document.getElementById('email').value = user.email;
    document.getElementById('resume').value = user.resume || '';
    document.getElementById('skills').value = user.skills?.join(', ') || '';
  }

  loadProfile();

  // Submit updated profile
  document.getElementById('profileForm').addEventListener('submit', async function (e) {
    e.preventDefault();

    const res = await fetch('/api/profile/update', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        Authorization: `Bearer ${token}`
      },
      body: JSON.stringify({
        name: document.getElementById('name').value,
        resume: document.getElementById('resume').value,
        skills: document.getElementById('skills').value.split(',').map(s => s.trim())
      })
    });

    const result = await res.json();
    alert(result.message || 'Profile updated!');
  });
</script>

</body>
</html>
